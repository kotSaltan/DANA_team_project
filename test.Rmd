---
title: "Hotspot_EDA_Report"
output: html_document
date: "2024-07-13"
---

```{r}
# Load libraries and set seed
library(readr)
library(readxl)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(corrplot)
library(gridExtra)
library(reshape2)
library(GGally)
library(caret)
library(dbscan)
library(scales)
set.seed(123)

```

#### Set project path and load dataset

```{r}
# Get the name of working directory in RProject
proj.path <- getwd()
hotspots_raw <- read_csv(file.path(proj.path,'hotspots.csv'))
```

#### Convert date format

```{r}
# Check the date format
hotspots_raw$rep_date <- as.POSIXct(hotspots_raw$rep_date, format = "%Y-%m-%d %H:%M:%S")
str(hotspots_raw$rep_date)

# Add year and month columns
hotspots_raw$year <- year(hotspots_raw$rep_date)
hotspots_raw$month <- month(hotspots_raw$rep_date, label = TRUE, abbr = TRUE)  # Months as factor (and named)

```

#### Subset data from period 2014 - 2023 (10 years)

```{r}
# Subset the dataframe to include only data from 2014 to the end of 2023
hotspots <- hotspots_raw %>%
  filter(year >= 2014 & year <= 2023)

# Check range of date
range(hotspots$rep_date) # 10 years period for further observations
```

#### **To identify specific fire events, apply DBSCAN (Density-Based Spatial Clustering of Application with Noise) function and classify every data point into cluster. The number of clusters has to be close to the official information from BC Website (<https://www2.gov.bc.ca/gov/content/safety/wildfire-status/about-bcws/wildfire-statistics/wildfire-averages>)**

```{r}
# Prepare the data for clustering based on latitude, longitude, date
event_data <- hotspots %>%
  select(lat, lon, rep_date)

# Convert date to numeric for clustering
event_data$date_numeric <- as.numeric(as.POSIXct(event_data$rep_date))

# View event_data
head(event_data)
```

#### Scale the converted date in numeric to have similar range as latitude / longitude. 1 degree of coordinate is \~ 111 km and 20 hours \~ 72000 seconds. Add new column named event_cluster to the hotspots dataset

```{r}
# Scale factor : 1 second ~ 0.001 degrees (approximately)
event_data$date_scaled <- event_data$date_numeric * 0.001

# Apply DBSCAN clustering
db <- dbscan(event_data[, c("lat", "lon", "date_scaled")], eps = 0.6, minPts = 5)
# eps value of 0.6 degrees is about 66 km

# Add cluster labels to the original dataset
hotspots$event_cluster <- db$cluster
```

#### Preview single specific event for observation

```{r}
# Filter for a specific cluster (event of fire) for sample
event_500 <- hotspots %>%
  filter(event_cluster == 500)# Replace with the specific cluster number

event_500
# OUTPUT 14 observations lat 53 lon -124 on 16 July 2014
```

#### Count the events without noise included

```{r}
# Count the number of unique clusters
num_clusters <- length(unique(hotspots$event_cluster))-1 # Subtract 1 to exclude the noise cluster (label 0)
num_clusters

# Total number of fires in BC (official table)
2293+1801+1647+670+825+2117+1353+1050+1858+1481+1861
# 16956
```

#### Summary of the clusters

```{r}

# Detailed summary of the clusters
event_details <- hotspots %>%
  filter(event_cluster != 0) %>%
  group_by(year) %>%
  summarise(
    first_cluster = first(event_cluster),
    start_date_hotspot = min(rep_date),
    end_date_hotspot = max(rep_date),
    events_count = length(unique(event_cluster))
  )
print(event_details)

# First_cluster column : Number of cluster started from 1 and increase based on the following fire cluster and grouped by year.
# Start_date_hotspot : Start date of fire event captured by hotspot
# End_date_hotspot : End date of fire event captured by hotspot
# Events_count : Total number of fire event in yearly basis based on cluster.
```

#### Analysis on the fire events in graphs.

```{r}
# In order to identify the time period to focus on and further yearly basis comparison purpose, summarize the number of cluster per year and month (exclude number of noise)

# Summarize the number of fire events per year and month
fire_events_per_month <- hotspots %>%
  filter(event_cluster != 0) %>%  # Exclude noise clusters
  group_by(year, month) %>%
  summarise(n_events = n()) %>%
  ungroup()

# Print the summary table
print(fire_events_per_month)

# Reshape the data to a wide format
fire_events_wide <- fire_events_per_month %>%
  pivot_wider(names_from = month, values_from = n_events, values_fill = 0)

# Print the wide format summary table
print(fire_events_wide)

```

#### The table summary shows how the clustered fire events are counted in yearly basis per monthly views.

#### Distribution of the clustered fire events in bar plot.

```{r}
# Create a bar plot to visualize the number of fire events per month
ggplot(fire_events_per_month, aes(x = month, y = n_events)) +
  geom_bar(stat = "identity", fill = "steelblue", color = "black") +
  labs(title = "Number of Fire Events per Month",
       x = "Month",
       y = "Number of Fire Events") +
  scale_y_continuous(labels = scales::comma) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))

```

#### The bar plot shows that the initial start of fire event is from May and significantly increased from July to September.

#### Visualize fire events with heatmap

```{r}

# Define the color palette
colors <- c("gray95", "gray80", "yellow", "orange", "darkred", "black")

# Define the values for the color breaks
values <- c(0, 500, 1000, 2000, 10000, 350000)

# Create a heatmap to visualize the number of fire events per month and year
ggplot(fire_events_per_month, aes(x = month, y = factor(year), fill = n_events)) +
  geom_tile(color = "white") +
  scale_fill_gradientn(colors = colors, values = rescale(values), labels = scales::comma) +
  labs(title = "Number of Fire Events per Month and Year",
       x = "Month",
       y = "Year",
       fill = "Number of Events") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))

```

#### From the heatmap, decided to concentrate from May to October for further analysis.

```{r}
# Subset the data for the months from May to October
hotspots_peak <- hotspots %>%
  filter(month(rep_date) %in% c(5, 6, 7, 8, 9, 10))

# MAKE A HEATMAP
# Summarize the number of fire events per year and month
fire_events_per_month_subset <- hotspots_peak %>%
  filter(event_cluster != 0) %>%
  group_by(year, month) %>%
  summarise(n_events = n()) %>%
  ungroup()

# Print the summary table
print(fire_events_per_month_subset)

# Reshape the data to a wide format
fire_events_wide2 <- fire_events_per_month_subset %>%
  pivot_wider(names_from = month, values_from = n_events, values_fill = 0)

# Print the wide format summary table
print(fire_events_wide2)
```

#### Visualize the peak fire events with heatmap

```{r}
# Create a heatmap to visualize the number of fire events per month and year
ggplot(fire_events_per_month_subset, aes(x = month, y = factor(year), fill = n_events)) +
  geom_tile(color = "white") +
  scale_fill_gradientn(colors = colors, values = rescale(values), labels = scales::comma) +
  labs(title = "Number of Fire Events per Month and Year (Peak)",
       x = "Month",
       y = "Year",
       fill = "Number of Events") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

Final view of subset heatmap from May - October for further analysis.

#### Explore and Interpretation of data variables to determine further data concentration.

#### Coordinate (Latitude and Longitude)

```{r}
range(hotspots$lat, na.rm = TRUE) #range is valid
range(hotspots$lon, na.rm = TRUE) #range is valid

# British Columbia coordinate :
# Latitude: Between 48.309789째N and 60.00065째N
# Longitude: Between -139.058200 째W and -114.05423째W
```

#### Rep_date (Date range)

```{r}
# Extract year and number of points from event_details
events_count <- event_details %>%
  select(year, events_count)

# Check the extracted table
print(events_count)
```

The period of data covers 10 years period started from 2014 and included the major fire events in 2023.

#### Show the summary of hotspots dataset in days count per year

```{r}
# Create summary table describing each hotspots dataset by year
hotspots_df_summary <- hotspots %>%
  group_by(year) %>%
  summarise(
    start_date = min(rep_date),
    end_date = max(rep_date),
    hotspots_df_day_count = as.numeric(difftime(max(rep_date), min(rep_date), units = "days"))
  )

hotspots_df_summary
# Create summary table describing each hotspots dataset by year
hotspots_df_summary <- hotspots_df_summary %>%
  left_join(events_count, by = "year") %>%
  mutate(
    start_month_day = format(as.Date(start_date), "%m-%d"),
    end_month_day = format(as.Date(end_date), "%m-%d")
  )
print(hotspots_df_summary)

```

***This table shows the beginning and end day of data collected by yearly basis with number of fire event counts. The notable finding is started from 2021 to 2023, it shows the data recorded in full year round, making it has more data point reference and can increase accuracy of analysis.***

#### UID (Identifier)

```{r}
# Display the first 10 rows as preview
hotspots %>%
  select(uid) %>%
  head(10)  # Display the first 10 rows

# The range of UID
range(hotspots$uid, na.rm = TRUE)

# The uid variable is present in historical datasets up to 2019 and absent for the rest of the year hence 40% value is missing.
```

#### Source (Source of hotspots)

```{r}
hotspots %>% 
  select(source) %>% 
  count(source)

sourse_cluster_count <- hotspots %>%
  group_by(source) %>%
  summarise(num_clusters = n_distinct(event_cluster))

# Create a bar plot of the number of clusters per satellite
ggplot(sourse_cluster_count, aes(x = source, y = num_clusters)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Number of Events Reported by Each Source",
       x = "Source",
       y = "Number of Events (clusters)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Sensor (Satellite sensor)

```{r}
hotspots %>% 
  select(sensor) %>% 
  count(sensor)

sensor_cluster_count <- hotspots %>%
  group_by(sensor) %>%
  summarise(num_clusters = n_distinct(event_cluster))

# Create a bar plot of the number of clusters per satellite
ggplot(sensor_cluster_count, aes(x = sensor, y = num_clusters)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Number of Events Reported by Each Sensor",
       x = "Sensor",
       y = "Number of Events (clusters)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

#Advanced Very High Resolution Radiometer (AVHRR) imagery, courtesy of the NOAA
#Moderate Resolution Imaging Spectroradiometer (MODIS) imagery, courtesy of the NASA
#Visible Infrared Imaging Radiometer Suite (VIIRS) imagery, courtesy of NASA LANCE FIRMS
```

#### Agency (indicate province)

```{r}
hotspots %>% 
  select(agency) %>% 
  count(agency)
# only output is BC as the main area of concentration

```

#### Variables with numerical columns

```{r}
# Identify numerical columns to work with
numerical_columns <- c('temp',
                       'rh',
                       'ws',
                       'wd',
                       'pcp',
                       'ffmc',
                       'dmc',
                       'dc',
                       'isi',
                       'bui',
                       'fwi',
                       'ros',
                       'sfc',
                       'tfc',
                       'bfc',
                       'hfi',
                       'cfb',
                       'age',
                       'estarea',
                       'pcuring',
                       'cfactor',
                       'greenup',
                       'elev',
                       'cfl',
                       'tfc0',
                       'sfl',
                       'ecozone',
                       'sfc0',
                       'cbh')
```

#### Statistical summary of numerical variables in hotspots dataset.

```{r}
# Function to describe each numerical column 
describe_numerical <- function(df, cols) {
  summary_list <- list()
  
  for (col in cols) {
    summary_stats <- data.frame(
      Variable = col,
      Missing_Values = sum(is.na(df[[col]])),
      Min = round(min(df[[col]], na.rm = TRUE), 2),
      Median = round(median(df[[col]], na.rm = TRUE), 2),
      Mean = round(mean(df[[col]], na.rm = TRUE), 2),
      Max = round(max(df[[col]], na.rm = TRUE), 2)
    )
    summary_list[[col]] <- summary_stats
  }
  
  summary_table <- bind_rows(summary_list)
  return(summary_table)
}

# Describe numerical columns for hotspots 
summary_hotspots <- describe_numerical(hotspots, numerical_columns)

# Print the summary table
print(summary_hotspots)
```

#### Statistical summary of numerical variables in peak period from the hotspots dataset

```{r}
# Describe numerical columns for hotspots_peak
summary_hotspots_peak <- describe_numerical(hotspots_peak, numerical_columns)

# Print the summary table
print(summary_hotspots_peak)
```
The statistical summary of the hotspots_peak dataset shows that there are no missing values in key variables, used by Canadian Forest Fire Weather Index (FWI) System, therefore we can continue with visual analysis and provide detailed description.

#### Summarize table with mean values for plots.

```{r}
# Create a table with mean values for plots

# Monthly averages for temp, rh, ws and pcp
monthly_avg <- hotspots_peak %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)

```

#### Temp (Temperature)

```{r}

par(mfrow=c(1,2))

# Histogram to show distribution of temperatures
ggplot(hotspots, aes(x = temp)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Temperature at Fire Hotspots",
       x = "Temperature (째C)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) +  # Adjust y-axis labels to numeric format (scales package)
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))

# Histogram to show distribution of temp for hotspots_peak
ggplot(hotspots_peak, aes(x = temp)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Temperature at Fire Hotspots (Peak)",
       x = "Temperature (째C)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
# Create a box plot to compare temperature distributions across years
ggplot(hotspots_peak, aes(x = factor(year), y = temp)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Temperature Distribution Across Years (Peak)",
       x = "Year",
       y = "Temperature (째C)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))

```

```{r}
# Create a summary table with mean temperature by year
mean_temp_by_year <- hotspots_peak %>%
  group_by(year) %>%
  summarise(mean_temp = mean(temp, na.rm = TRUE))

# Create a line plot to show temperature trends over years
ggplot(mean_temp_by_year, aes(x = year, y = mean_temp)) +
  geom_line(color = "steelblue", size = 1) +
  geom_point(color = "black", size = 2) +
  labs(title = "Average Temperature Over Years (Peak)",
       x = "Year",
       y = "Average Temperature (째C)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))

```

```{r}
# Create a line plot for temperature in 2019 for closer look of drop temperature.
ggplot(hotspots_peak %>% filter(year == 2019), aes(x = rep_date, y = temp)) +
  geom_line(color = "steelblue") +
  labs(title = "Temperature Over the Year 2019",
       x = "Date",
       y = "Temperature (째C)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

The line plot shows that temperature gradually drop from \~20 degree to 0 degree started from July to October indicated the end of dry season.

Closer look for the temperature comparison from 4 major different years with most case of fires. 2014 : started of hotspot dataset 2018 : the historical year of wildfire in BC 2020 : the global pandemic year where not much fires recorded 2023 : the largest wildfire events.

```{r}
# Define common axis limits
y_limits <- range(hotspots_peak$temp[hotspots_peak$year %in% c(2014, 2018, 2020, 2023)])

# Create plots with common axis limits
plot_2014 <- ggplot(hotspots_peak %>% filter(year == 2014), aes(x = rep_date, y = temp)) +
  geom_line(color = "steelblue") +
  labs(title = "Temperature Over the Peak Season 2014",
       x = "Date",
       y = "Temperature (째C)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = y_limits)

plot_2018 <- ggplot(hotspots_peak %>% filter(year == 2018), aes(x = rep_date, y = temp)) +
  geom_line(color = "steelblue") +
  labs(title = "Temperature Over the Peak Season 2018",
       x = "Date",
       y = "Temperature (째C)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = y_limits)

plot_2020 <- ggplot(hotspots_peak %>% filter(year == 2020), aes(x = rep_date, y = temp)) +
  geom_line(color = "steelblue") +
  labs(title = "Temperature Over the Peak Season 2020",
       x = "Date",
       y = "Temperature (째C)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = y_limits)

plot_2023 <- ggplot(hotspots_peak %>% filter(year == 2023), aes(x = rep_date, y = temp)) +
  geom_line(color = "steelblue") +
  labs(title = "Temperature Over the Peak Season 2023",
       x = "Date",
       y = "Temperature (째C)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = y_limits)

# Create Line Plots for 4 different years to compare temp
grid.arrange(plot_2014, plot_2018, plot_2020, plot_2023, ncol = 2)


# Trend on temperature drop in October from different years, showing consistent trend and considered common because its beginning of Fall season in BC
```

#### RH (Relative Humidity)

```{r}
# The amount of moisture in the air as a percentage
# 0 to 100 with a mean 36

# Create Line Plots for 4 different years to compare RH

# Define common axis limits
y_limits <- range(hotspots_peak$rh[hotspots_peak$year %in% c(2014, 2018, 2020, 2023)])
# Create plots with common axis limits
plot_2014 <- ggplot(hotspots_peak %>% filter(year == 2014), aes(x = rep_date, y = rh)) +
  geom_line(color = "steelblue") +
  labs(title = "Humidity Over the Peak Season 2014",
       x = "Date",
       y = "Relative Humidity (%)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = y_limits)

plot_2018 <- ggplot(hotspots_peak %>% filter(year == 2018), aes(x = rep_date, y = rh)) +
  geom_line(color = "steelblue") +
  labs(title = "Humidity Over the Peak Season 2018",
       x = "Date",
       y = "Relative Humidity (%)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = y_limits)

plot_2020 <- ggplot(hotspots_peak %>% filter(year == 2020), aes(x = rep_date, y = rh)) +
  geom_line(color = "steelblue") +
  labs(title = "Humidity Over the Peak Season 2020",
       x = "Date",
       y = "Relative Humidity (%)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = y_limits)

plot_2023 <- ggplot(hotspots_peak %>% filter(year == 2023), aes(x = rep_date, y = rh)) +
  geom_line(color = "steelblue") +
  labs(title = "Humidity Over the Peak Season 2023",
       x = "Date",
       y = "Relative Humidity (%)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(limits = y_limits)

# Arrange the plots side by side
grid.arrange(plot_2014, plot_2018, plot_2020, plot_2023, ncol = 2)

# The variability in relative humidity makes it difficult to establish a consistent trend. 
```

#### Comparison betweent temperature and humidity (RH) from 4 different years.

```{r}
# Plot compare the temperature and humidity from 4 different years
# Filter for specific years
monthly_avg_filtered <- monthly_avg %>% 
  filter(year %in% c(2014, 2018, 2020, 2023))

# Plot monthly temperature averages
temp_plot_filtered <- ggplot(monthly_avg_filtered, aes(x = month, y = avg_temp, color = factor(year), group = year)) +
  geom_line(size = 1) +
  labs(title = "Average Temperature by Month",
       x = "Month",
       y = "Average Temperature (째C)",
       color = "Year") +
  scale_color_manual(values = c("2014" = "lightblue", "2018" = "plum", "2020" = "lightgreen", "2023" = "lightcoral")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Plot monthly humidity averages
humidity_plot_filtered <- ggplot(monthly_avg_filtered, aes(x = month, y = avg_rh, color = factor(year), group = year)) +
  geom_line(size = 1) +
  labs(title = "Average Humidity by Month",
       x = "Month",
       y = "Average Humidity (%)",
       color = "Year") +
  scale_color_manual(values = c("2014" = "lightblue", "2018" = "plum", "2020" = "lightgreen", "2023" = "lightcoral")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Arrange the plots side by side
grid.arrange(temp_plot_filtered, humidity_plot_filtered, ncol = 2)

```

**There is a combination of high temperatures and low humidity during the peak fire months (June to September). 2018 and 2023 had higher temperatures and lower humidity, meaning more fires.\
When humidity rises sharply in October, fire activity goes down,indicating the end of the peak fire season.**

#### Wind speed (in km/h)

```{r}
# 0 to 59 with mean of 9
# Higher wind speeds in peak fire months can make fire more intense and make it spread faster.

# Plot monthly wind speed averages with custom colors
ws_plot_filtered <- ggplot(monthly_avg_filtered, aes(x = month, y = avg_ws, color = factor(year), group = year)) +
  geom_line(size = 1) +
  labs(title = "Average Wind Speed by Month",
       x = "Month",
       y = "Average Wind Speed (m/s)",
       color = "Year") +
  scale_color_manual(values = c("2014" = "lightblue", "2018" = "plum", "2020" = "lightgreen", "2023" = "lightcoral")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Arrange the plots side by side
grid.arrange(temp_plot_filtered, humidity_plot_filtered, ws_plot_filtered, ncol = 3)

```

#### Wind exploration with openair() package.

```{r}
# Visualise with Wind Rose to see most common wind direction
library(openair)

windRose(mydata = hotspots_peak, ws = "ws", wd = "wd", 
         main = "Wind Rose", paddle = FALSE)

# Most of the wind comes from the west (W) and southwest (SW). 
# Regions east and north of areas with strong western, southern and southwestern winds
# should be careful, as these winds can quickly spread fires.
# Wind patterns have are important for wildfire management.

```

#### Most of the wind comes from the west (W) and southwest (SW).Regions east and north of areas with strong western, southern and southwestern wind should be careful, as these winds can quickly spread fires.

#### Wind patterns have are important for wildfire management. **Higher wind speeds in peak fire months can make fire more intense and make it spread faster.Wind speed shows significant variability.**

## pcp (Precipitation)

```{r}
# 0 to 651 with mean of 0.2
# So the amount is very low generally

par(mfrow=c(1,2))

# Plot monthly precipitation averages
ggplot(monthly_avg, aes(x = month, y = avg_pcp, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Dashed line for trend
  labs(title = "Average Precipitation by Month",
       x = "Month",
       y = "Average Precipitation (mm)",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Plot monthly precipitation averages
ggplot(monthly_avg, aes(x = month, y = avg_pcp, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Dashed line for trend
  labs(title = "Average Precipitation by Month",
       x = "Month",
       y = "Average Precipitation (mm)",
       color = "Year") +
  scale_color_manual(values = c("2014" = "lightblue", "2018" = "plum", "2020" = "lightgreen", "2023" = "lightcoral")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### The plot indicates a clear seasonal variation in precipitation, with a noticeable peak in July for most years.

## Fire Weather Index System indices

```{r}
# Monthly averages for temp, rh, ws and pcp, ffmc, dmc
monthly_avg <- hotspots_peak %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)
```

#### FFMC (Fine Fuel Moisture Code)

```{r}
# A numeric rating of the moisture content of litter and other cured fine fuels.
# This code is an indicator of the relative ease of ignition and the flammability of fine fuel.

# The FFMC scale ranges from 0 to 101.
# 0-30: Very wet conditions; ignition is difficult.
# 30-70: Damp conditions; moderate difficulty for ignition.
# 70-85: Dry conditions; fuels are easily ignitable.
# 85-101: Very dry conditions; fuels are highly ignitable and fires can spread rapidly.

# Plot histogram for FFMC
ggplot(hotspots_peak, aes(x = ffmc)) +
  geom_histogram(binwidth = 2, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of FFMC Values", x = "FFMC", y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal()
```

#### The histogram reveals that most FFMC values from 2014 to 2023 are between 85 and 99,confirming consistently dry conditions.

```{r}
# Plot boxplot for FFMC
ggplot(hotspots_peak, aes(x = factor(year), y = ffmc)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "FFMC Distribution Across Years",
       x = "Year",
       y = "FFMC") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### The boxplots show that most years have high FFMC values above 90,meaning conditions are very dry and prone to fires. Only 2020 shows slightly lower dryness.

```{r}
# Line plot for FFMC over time
ggplot(monthly_avg, aes(x = month, y = avg_ffmc, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Dashed line for trend
  labs(title = "FFMC by Month",
       x = "Month",
       y = "FFMC",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

#### The line plot shows that FFMC values peak every year during the fire season,indicating drier conditions that make it easier for fires to start.

#### DMC (Duff Moisture Code)

```{r}
# A numeric rating of the average moisture content
# of loosely compacted organic layers of moderate depth. 
# This code gives an indication of fuel consumption in moderate duff layers 
# and medium-size woody material.

# Values below 20: Low fire danger, duff layers are wet, and ignition is unlikely.
# Values between 21 and 40: Moderate fire danger, duff layers start drying.
# Values between 41 and 100: High fire danger, the duff layer is dry, prone to ignition.
# Values above 100: Extreme fire danger, the duff layer is very dry, and ignition is very likely with the potential for intense fires.

# Plot histogram for DMC
ggplot(hotspots_peak, aes(x = dmc)) +
  geom_histogram(binwidth = 2, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of DMC Values", x = "DMC", y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal()

```

#### The histogram shows that most DMC values range between 0 and 100,with a peak around 50-100. Values above 200 are less common but indicate long dry periods.

```{r}
# Plot boxplot for DMC
ggplot(hotspots_peak, aes(x = factor(year), y = dmc)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "DMC Distribution Across Years",
       x = "Year",
       y = "DMC") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))

```

#### The boxplot for each year reveals that 2017 and 2018 had particularly high outliers,indicating extremely dry conditions that could lead to fires.

#### On the other hand, 2016 and 2019 had lower DMC values, showing less severe drought.

```{r}
# Line plot for DMC over time
ggplot(monthly_avg, aes(x = month, y = avg_dmc, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Dashed line for trend
  labs(title = "DMC by Month",
       x = "Month",
       y = "DMC",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### The line plot indicates that DMC values peak in late summer (July-August) and decrease in autumn.

#### This shows that mid to late summer is typically drier,the risk of fire ignition and spread is high during these months.

```{r}
# ADD NEW MEAN VALUES
# Monthly averages for temp, rh, ws and pcp, ffmc, dmc, dc
monthly_avg <- hotspots_peak %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            avg_dc = mean(dc, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)

```

#### DC (Drought Code)

```{r}
# A numeric rating of the average moisture content of deep, compact organic layers.
# This code is a useful indicator of seasonal drought effects on forest fuels
# and the amount of smoldering in deep duff layers and large logs.

# 0-100: Indicates wet conditions with low fire potential.
# 100-300: Moderate drought conditions with increasing fire potential.
# 300-500: High drought conditions, leading to high fire risk.
# 500+: Indicates extreme drought, posing a very high fire risk and potential for intense, prolonged burning.

# Plot histogram for DC
ggplot(hotspots_peak, aes(x = dc)) +
  geom_histogram(binwidth = 20, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of DC Values", x = "DC", y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal()

```

#### The histogram of DC values from 2014 to 2023 shows most values are between 300 and 600,peaking around 500. This means BC often has conditions that can lead to deep-burning fires.

```{r}
# Plot boxplot for DC
ggplot(hotspots_peak, aes(x = factor(year), y = dc)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "DC Distribution Across Years",
       x = "Year",
       y = "DC") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### The boxplot of DC values across years show the variability and trends in drought conditions over time.

#### 2017 and 2018: These years have higher median and upper whisker values, meaning very dry conditions, likely leading to severe fire seasons.

#### 2016 and 2019: These years show lower DC values, suggesting wetter conditions and potentially less severe fire activity.

```{r}
# Line plot for DC over time
ggplot(monthly_avg, aes(x = month, y = avg_dc, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Dashed line for trend
  labs(title = "DC by Month",
       x = "Month",
       y = "DC",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

#### The line plot of DC values by month shows a clear seasonal trend,

#### DC values increase during the summer months (July to August) and decrease in the autumn.

#### This occurs at the time of the peak fire season.

#### There are a lot of high DC values, more than 500, it shows conditions for deep-burning fires.

```{r}
monthly_avg <- hotspots_peak %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            avg_dc = mean(dc, na.rm = TRUE),
            avg_isi = mean(isi, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)

```

#### ISI (Initial Spread Index)

```{r}
# A numerical rating of the expected rate of fire spread
# based on wind speed, temperature, and fine fuel moisture content. 
# ISI is crucial for understanding how quickly a fire can spread once it has ignited.

# 0-3: Low spread potential. Fires will spread slowly and are relatively easy to control.
# 4-7: Moderate spread potential. Fires spread more quickly and may require more effort to control.
# 8-12: High spread potential. Fires spread rapidly and can be difficult to control.
# 13-19: Very high spread potential. Fires spread very rapidly and are challenging to control.
# 20+: Extreme spread potential. Fires spread uncontrollably and can be extremely dangerous.

# Plot histogram for ISI
ggplot(hotspots_peak, aes(x = isi)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of ISI Values", x = "ISI", y = "Frequency") +
  scale_y_continuous(labels = scales::comma) + 
  theme_minimal()
```

#### The histogram indicates that most ISI values are low to moderate.

```{r}
# Plot boxplot for ISI
ggplot(hotspots_peak, aes(x = factor(year), y = isi)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "ISI Distribution Across Years",
       x = "Year",
       y = "ISI") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### The boxplot shows variability in ISI values across years, with notable outliers in 2014 and 2020.

```{r}
# Line plot for ISI over time
ggplot(monthly_avg, aes(x = month, y = avg_isi, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Smoothed trend line
  labs(title = "ISI by Month",
       x = "Month",
       y = "ISI",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### The graphs illustrate that ISI values tend to peak during the summer months,indicating higher fire spread potential during this period.

```{r}
# To improve the clarity of these insights,
# removing NA values and extreme outliers from the dataset is necessary.
# Remove extreme outliers
hotspots_peak_filtered <- hotspots_peak%>%
  filter(isi < 60)
dim(hotspots_peak_filtered)

# Filter out entries with ISI values greater than 75
event_outliers <- hotspots_peak %>%
  filter(isi >= 60)

# Check single event
dim(event_outliers)
view(event_outliers)
```

#### Sample of one specific event with FWI index

```{r}
# Filter the specific event cluster and near events
event_McAllister <- hotspots %>%
  filter(event_cluster %in% 370:372) 

# Calculate monthly averages for July 2014
monthly_avg_july <- monthly_avg %>%
  filter(year == 2014 & month == "Jul")

# Plot the weather conditions with average lines
ggplot(event_McAllister, aes(x = rep_date)) +
  geom_point(aes(y = temp, color = "Temperature"), size = 3) +
  geom_point(aes(y = rh, color = "Relative Humidity"), size = 3) +
  geom_point(aes(y = ws, color = "Wind Speed"), size = 3) +
  geom_hline(aes(yintercept = monthly_avg_july$avg_temp, color = "Avg Temperature"), linetype = "dashed") +
  geom_hline(aes(yintercept = monthly_avg_july$avg_rh, color = "Avg Relative Humidity"), linetype = "dashed") +
  geom_hline(aes(yintercept = monthly_avg_july$avg_ws, color = "Avg Wind Speed"), linetype = "dashed") +
  labs(title = "Weather Conditions on July 19, 2014 with Monthly Averages",
       x = "Date",
       y = "Value",
       color = "Variable") +
  scale_color_manual(values = c("Temperature" = "red3", "Relative Humidity" = "steelblue2", "Wind Speed" = "green",
                                "Avg Temperature" = "red3", "Avg Relative Humidity" = "steelblue2", "Avg Wind Speed" = "green")) +
  theme_minimal()


# Create a summary table of the weather conditions
weather_summary <- event_McAllister %>%
  select(lat, lon, rep_date, temp, rh, ws, wd, pcp, ffmc, dmc, dc, isi, bui, fwi, ros)

# Print the summary table
print(weather_summary)


```

#### This graph shows the weather conditions at McAllister Creek on July 19, 2014,including temperature, relative humidity, and wind speed.

#### It compares these values to the average conditions for July 2014.

#### The wind speed during this event is notably higher than the monthly average,suggesting stronger winds that could help spread the fire.

```{r}
monthly_avg <- hotspots_peak_filtered %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            avg_dc = mean(dc, na.rm = TRUE),
            avg_isi = mean(isi, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)
```

```{r}

# Plot histogram for ISI
ggplot(hotspots_peak_filtered, aes(x = isi)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of ISI Values", x = "ISI", y = "Frequency") +
  scale_y_continuous(labels = scales::comma) + 
  theme_minimal()

```

#### The histogram now shows a more typical range of ISI values, removing the extreme values that distorted the original plot.

```{r}

# Plot boxplot for ISI
ggplot(hotspots_peak_filtered, aes(x = factor(year), y = isi)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "ISI Distribution Across Years",
       x = "Year",
       y = "ISI") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))

```

#### The boxplot shows a clearer, more consistent ISI distribution across the years after removing high outliers.

```{r}
# Line plot for ISI over time
ggplot(monthly_avg, aes(x = month, y = avg_isi, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Smoothed trend line
  labs(title = "ISI by Month",
       x = "Month",
       y = "ISI",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### The seasonal pattern plot still peaks in mid-summer but appears smoother without the extreme values.Wind speed greatly affects ISI, as seen on July 19, 2014, at McAllister Creek, where high wind speeds caused high ISI values.

```{r}
# SHOW CORRELATION OF ISI AND WEATHER INDICES
monthly_avg <- hotspots_peak_filtered %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            avg_dc = mean(dc, na.rm = TRUE),
            avg_isi = mean(isi, na.rm = TRUE),
            avg_bui = mean(bui, na.rm = TRUE),
            avg_fwi = mean(fwi, na.rm = TRUE),
            avg_ros = mean(ros, na.rm = TRUE),
            avg_hfi = mean(hfi, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)


```

```{r}
# Using monthly averages instead of individual observations for quicker plotting

ggplot(monthly_avg, aes(x = avg_ws, y = avg_isi)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(title = "Average ISI vs Average Wind Speed", x = "Average Wind Speed (km/h)", y = "Average ISI") +
  theme_minimal()
```

#### Average ISI vs. Average Wind Speed: Shows that higher wind speeds are linked to higher ISI values.

```{r}
ggplot(monthly_avg, aes(x = avg_temp, y = avg_isi)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(title = "Average ISI vs Average Temperature", x = "Average Temperature (째C)", y = "Average ISI") +
  theme_minimal()
```

#### Average ISI vs. Average Temperature: Shows that higher temperatures are associated with higher ISI values.

```{r}
ggplot(monthly_avg, aes(x = avg_rh, y = avg_isi)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "green") +
  labs(title = "Average ISI vs Average Relative Humidity", x = "Average Relative Humidity (%)", y = "Average ISI") +
  theme_minimal()

```

#### Average ISI vs. Average Relative Humidity: Shows that as relative humidity increases, ISI decreases.

```{r}
# Select columns 
data_corr <- hotspots_peak_filtered %>%
  select(isi, ws, temp, rh)

# Calculate the correlation matrix
corr_matrix <- cor(data_corr)

# Plot the correlation matrix
corrplot(corr_matrix, method = "circle", type = "lower",
         tl.col = "black", tl.srt = 45, title = "Correlation Matrix of ISI and Weather Variables",
         mar = c(0, 0, 1, 0))
```

#### Strong negative correlation between ISI and relative humidity. Strong positive correlation between ISI and temperature. Moderate positive correlation between ISI and wind speed.

#### BUI (Buildup Index)

```{r}
# A numerical rating of the total amount of fuel available for combustion.
# It is derived from the Duff Moisture Code (DMC) and the Drought Code (DC)

# Low: 0-40
# Moderate: 41-80
# High: 81-120
# Extreme: 121 and above

ggplot(hotspots_peak_filtered, aes(x = bui)) +
  geom_histogram(binwidth = 10, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of BUI Values", x = "BUI", y = "Frequency") +
  scale_y_continuous(labels = scales::comma) + 
  theme_minimal()

```

#### The histogram shows that BUI values mostly range from 60 to 100. This means the fire potential is moderate to high for most of the dataset.

```{r}

ggplot(hotspots_peak_filtered, aes(x = factor(year), y = bui)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "BUI Distribution Across Years",
       x = "Year",
       y = "BUI") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### Boxplots show BUI values vary year to year. Some years have higher values, which means drier conditions and a higher chance of intense fires.

```{r}

ggplot(monthly_avg, aes(x = month, y = avg_bui, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Smoothed trend line
  labs(title = "BUI by Month",
       x = "Month",
       y = "BUI",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

#### BUI peaks in mid-summer, which matches the time when fire activity is usually the highest.

```{r}

# Scatter plots to visualize relationships using average values
ggplot(monthly_avg, aes(x = avg_dmc, y = avg_bui)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(title = "Average BUI vs Average DMC", x = "Average DMC", y = "Average BUI") +
  theme_minimal()
```

#### BUI and DMC have a very strong positive correlation, indicating that they are closely related (fire potential and moisture of layer).

```{r}
ggplot(monthly_avg, aes(x = avg_dc, y = avg_bui)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(title = "Average BUI vs Average DC", x = "Average DC", y = "Average BUI") +
  theme_minimal()

```

#### BUI and DC also show a positive correlation,though it is slightly weaker.

```{r}
# Select columns
data_corr <- hotspots_peak_filtered %>%
  select(bui, dmc, dc)

# Calculate the correlation matrix
corr_matrix <- cor(data_corr)

# Plot the correlation matrix
corrplot(corr_matrix, method = "circle", type = "lower",
         tl.col = "black", tl.srt = 45, title = "Correlation Matrix of BUI, DMC, and DC",
         mar = c(0, 0, 1, 0))
```

#### BUI, DMC, and DC are all indicators of fire potential.

#### High values in these indices suggest drier conditions, which can lead to higher fire.

#### FWI (Fire Weather Index)

```{r}
# A numeric rating of fire intensity. It is based on the ISI and the BUI, 
# and is used as a general index of fire danger throughout the forested areas of Canada.

# Low (0-5): Minimal fire danger.
# Moderate (6-12): Fires can start from most accidental causes, but the spread is slow.
# High (13-20): Fires can start easily and spread rapidly.
# Very High (21-30): Fires will start very easily, spread rapidly, and burn intensely.
# Extreme (31+): Fires start and spread quickly, and are intense and challenging to control.

ggplot(hotspots_peak_filtered, aes(x = fwi)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of FWI Values", x = "FWI", y = "Frequency") +
  scale_y_continuous(labels = scales::comma) + 
  theme_minimal()

```

#### The histogram shows that most FWI values are between 10 and 30, fire danger is from moderate to very high. Many values are above 30, severe fire weather conditions are frequent.

```{r}
ggplot(hotspots_peak_filtered, aes(x = factor(year), y = fwi)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "FWI Distribution Across Years",
       x = "Year",
       y = "FWI") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### The boxplot shows the distribution of FWI values for different years.The line plot shows that FWI peaks in mid-summer, peak fire activity period.The data shows significant variability in fire danger, summer months and certain years have extreme outliers.

```{r}
ggplot(monthly_avg, aes(x = month, y = avg_fwi, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Smoothed trend line
  labs(title = "FWI by Month",
       x = "Month",
       y = "FWI",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

#### FWI varies significantly year to year due to a combination of climatic factors, such as temperature, precipitation, and wind speed. For deeper analyses and trends weather has to be closely inspected.

#### Fuel (Fuel Type)

```{r}
# D1: Deciduous trees (leafless, early spring to fall)
# C2, C3, C4, C5, C7: Various types of coniferous trees
# O1, O1a, O1b: Grass or herbaceous vegetation
# M1, M1M2, M2, M2_25, M2_35, M2_50, M2_65: Mixedwood or transitional vegetation
# bog: Wetland areas with peatland vegetation
# water: Water bodies
# urban: Urban areas
# non_fuel: Areas with no significant vegetation (rock, gravel)
# low_veg: Areas with low vegetation (possibly recently burned or cleared)
# farm: Agricultural areas
# D2: Deadfall or downed wood

# Group by fuel and summarize
fuel_counts <- hotspots_peak_filtered %>%
  group_by(fuel) %>%
  summarise(count = n()) %>%
  arrange(desc(count)) 

# Print the fuel counts
print(fuel_counts)
```

```{r}
# Create a bar plot for the fuel column
ggplot(hotspots_peak_filtered, aes(x = fuel)) +
  geom_bar(fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Fuel Types", x = "Fuel Type", y = "Count") +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### The dataset shows a variety of fuel types, with "C2" (566,651 records) and "C3" (383,781 records) being the most common. Other significant fuel types include "D1" (187,803 records) and "C7" (149,801 records).

"ros" (Rate of Spread)

```{r}
# The predicted speed of the fire at the front or head of the fire (where the fire moves fastest),and takes into account both crowning and spotting. 
# The scale ranges from 0 to over 20 m/min in the dataset.

ggplot(hotspots_peak_filtered, aes(x = ros)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution Rate of Spread at Fire Hotspots",
       x = "ROS (m/min)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))

```

```{r}
ggplot(hotspots_peak_filtered, aes(x = factor(year), y = ros)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Rate of Spread Distribution Across Years",
       x = "Year",
       y = "ROS (m/min)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### The plot shows that the ROS can vary significantly year to year, with some years experiencing more extreme fire spread conditions.

```{r}
# Scatter plot for average ROS vs average ISI
ggplot(monthly_avg, aes(x = avg_isi, y = avg_ros)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(title = "Average ROS vs Average ISI",
       x = "Average ISI",
       y = "Average ROS") +
  theme_minimal()

```

```{r}
# Scatter plot for average ROS vs average BUI
ggplot(monthly_avg, aes(x = avg_bui, y = avg_ros)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(title = "Average ROS vs Average BUI",
       x = "Average BUI",
       y = "Average ROS") +
  theme_minimal()
```

```{r}

 # Scatter plot for average ROS vs average FWI
ggplot(monthly_avg, aes(x = avg_fwi, y = avg_ros)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "lm", se = FALSE, color = "green") +
  labs(title = "Average ROS vs Average FWI",
       x = "Average FWI",
       y = "Average ROS") +
  theme_minimal()
```

#### The scatter plots for ROS vs FWI, ROS vs BUI, and ROS vs ISI all show a clear upward trend.This means that as the values of FWI, BUI, and ISI increase, the Rate of Spread also increases. Higher values indicate more severe fire conditions,more available fuel, and faster initial fire spread. This means the fire spreads faster.

```{r}
# Calculate correlations between ROS, ISI, BUI, and FWI
correlation_ros_indices <- hotspots_peak_filtered %>%
  select(ros, isi, bui, fwi) %>%
  cor(use = "complete.obs")

# Print the correlation matrix
print(correlation_ros_indices)


# Plot the correlation matrix
corrplot(correlation_ros_indices, method = "circle", type = "lower",
         tl.col = "black", tl.srt = 45, title = "Correlation Matrix of ROS and Other Indices",
         mar = c(0, 0, 1, 0))
```

#### The matrix shows strong positive correlations between ROS and ISI, ROS and FWI,and a moderate positive correlation between ROS and BUI.

#### "sfc" (Surface Fuel Consumption)

```{r}
monthly_avg <- hotspots_peak_filtered %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            avg_dc = mean(dc, na.rm = TRUE),
            avg_isi = mean(isi, na.rm = TRUE),
            avg_sfc = mean(sfc, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)
```

```{r}
ggplot(hotspots_peak_filtered, aes(x = sfc)) +
  geom_histogram(binwidth = 0.1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution Surface fuel Consumption at Fire Hotspots",
       x = "SFC (kg/m짼)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}

ggplot(hotspots_peak_filtered, aes(x = factor(year), y = sfc)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Surface Fuel Consumption Distribution Across Years",
       x = "Year",
       y = "SFC (kg/m짼)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### "tfc" (Total Fuel Consumption)

```{r}
monthly_avg <- hotspots_peak_filtered %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            avg_dc = mean(dc, na.rm = TRUE),
            avg_isi = mean(isi, na.rm = TRUE),
            avg_sfc = mean(sfc, na.rm = TRUE),
            avg_tfc = mean(tfc, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)
```

```{r}
ggplot(hotspots_peak_filtered, aes(x = tfc)) +
  geom_histogram(binwidth = 0.1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution Total Fuel Consumption at Fire Hotspots",
       x = "TFC (kg/m짼)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak_filtered, aes(x = factor(year), y = tfc)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Total Fuel Consumption Distribution Across Years",
       x = "Year",
       y = "TFC (kg/m짼)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### "bfc" (Bonfire Fuel Consumption)

```{r}
monthly_avg <- hotspots_peak_filtered %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            avg_dc = mean(dc, na.rm = TRUE),
            avg_isi = mean(isi, na.rm = TRUE),
            avg_sfc = mean(sfc, na.rm = TRUE),
            avg_tfc = mean(tfc, na.rm = TRUE),
            avg_bfc = mean(bfc, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)
```

```{r}
ggplot(hotspots_peak_filtered, aes(x = bfc)) +
  geom_histogram(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Bonfire Fuel Consumption at Fire Hotspots",
       x = "BFC (kg/square metre)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak_filtered, aes(x = factor(year), y = bfc)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Bonfire Fuel Consumption Distribution Across Years",
       x = "Year",
       y = "BFC (kg/square metre)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### "hfi" (Head Fire Intensity)

```{r}
# Measures the intensity or energy output of a fire at its front (head).
# HFI is measured in kilowatts per metre (kW/m) of the fire front and is calculated based on the Rate of Spread (ROS)
# and the Total Fuel Consumption (TFC).

# Low (0-500 kW/m): Fires are relatively easy to control and generally cause limited damage.
# Moderate (500-2000 kW/m): Fires can be challenging to control, requiring more resources and effort.
# High (2000-4000 kW/m): Fires are intense and difficult to manage, often requiring aerial firefighting resources.
# Very High (4000-10,000 kW/m): Fires are extremely intense and nearly impossible to control, posing significant risk to life and property.
# Extreme (10,000+ kW/m): Fires exhibit explosive behavior and can cause catastrophic damage.

monthly_avg <- hotspots_peak_filtered %>%
  group_by(year, month) %>%
  summarise(avg_temp = mean(temp, na.rm = TRUE),
            avg_rh = mean(rh, na.rm = TRUE),
            avg_ws = mean(ws, na.rm = TRUE),
            avg_pcp = mean(pcp, na.rm = TRUE),
            avg_ffmc = mean(ffmc, na.rm = TRUE),
            avg_dmc = mean(dmc, na.rm = TRUE),
            avg_dc = mean(dc, na.rm = TRUE),
            avg_isi = mean(isi, na.rm = TRUE),
            avg_sfc = mean(sfc, na.rm = TRUE),
            avg_tfc = mean(tfc, na.rm = TRUE),
            avg_bfc = mean(bfc, na.rm = TRUE),
            avg_hfi = mean(hfi, na.rm = TRUE),
            .groups = 'drop') 

print(monthly_avg)

# Plot histogram for HFI
ggplot(hotspots_peak_filtered, aes(x = hfi)) +
  geom_histogram(binwidth = 1000, fill = "skyblue", color = "black", alpha = 0.7) + # Each bin represent a range of 1000 HFI units.
  labs(title = "Distribution of HFI Values",
       x = "HFI (kW/m)",
       y = "Frequency") +
  scale_y_continuous(labels = scales::comma) + 
  scale_x_continuous(breaks = seq(0, 75000, 10000)) +
  theme_minimal()

```

#### The histogram shows the frequency distribution of HFI values.Most HFI values are concentrated at the lower end of the scale, as values increase there are fewer.

#### Very high HFI values are outliers they show occasional extremely intense fires. While most fires are less intense, the few high-intensity fires can be significant and impactful.

```{r}
ggplot(hotspots_peak_filtered, aes(x = factor(year), y = hfi)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "HFI Distribution Across Years",
       x = "Year",
       y = "HFI (kW/m)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

#### The boxplots show the distribution of HFI across different years.The median value varies yearly, there are fluctuations in fire intensity.There are significant outliers in almost all years, there are some fires with extremely high intensities.

```{r}

ggplot(monthly_avg, aes(x = month, y = avg_hfi, color = factor(year), group = year)) +
  geom_line(size = 0.5, alpha = 0.6, linetype = "dotted") +  # raw data
  geom_smooth(se = FALSE, method = "loess", size = 1, linetype = "solid") +  # Smoothed trend line
  labs(title = "HFI by Month",
       x = "Month",
       y = "HFI (kW/m)",
       color = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Different years show a lot of differences in HFI values. For example, 2014 and 2021 had higher peaks, meaning there was more intense fire activity in those years.

#### 2020 had lower HFI values, there were milder fire conditions or better fire control efforts.The plots also show how HFI can change from month to month within a single fire season.Weather conditions, temperature, humidity, and wind speed, can affect how fires behave.

"cfb" (Crown Fraction Burned)

```{r}
# CFB is the predicted fraction of the tree crowns consumed by the fire.
# 0 to 100 with a mean of 33
ggplot(hotspots_peak, aes(x = cfb)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Crown Fraction Burned at Fire Hotspots",
       x = "CFB",
       y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak, aes(x = factor(year), y = cfb)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Crown Fraction Burned Distribution Across Years",
       x = "Year",
       y = "CFB") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

"age" (Age of the Fuel)

```{r}
# an indicator of the time since the last significant wetting rain which affect the moisture content of the fuel
ggplot(hotspots_peak, aes(x = age)) +
  geom_histogram(binwidth = 5, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Windspeed at Fire Hotspots",
       x = "Age (in days)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak, aes(x = factor(year), y = age)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Age Distribution Across Years",
       x = "Year",
       y = "Age (in days)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

"est area" (Estimated Area Burned )

```{r}
ggplot(hotspots_peak, aes(x = estarea)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Windspeed at Fire Hotspots",
       x = "Estimate Area Burned (in hectares)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak, aes(x = factor(year), y = estarea)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Estimated Area Burned Distribution Across Years",
       x = "Year",
       y = "Estimated Area Burned (in hectares)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))

```

"polyid"

```{r}
# Display a few rows to show examples of polyid
hotspots %>%
  select(polyid) %>%
  head(10)  # Display the first 10 rows
range(hotspots$polyid, na.rm = TRUE)

```

"pcuring"

```{r}
# Percentage of vegetation that has cured
hotspots %>% 
  select(pcuring) %>% 
  count(pcuring)

range(hotspots$pcuring, na.rm = TRUE)
```

```{r}
pcuring_cluster_count <- hotspots %>%
  group_by(pcuring) %>%
  summarise(num_clusters = n_distinct(event_cluster))

```

```{r}
ggplot(pcuring_cluster_count, aes(x = pcuring, y = num_clusters)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Number of Clusters by Pcuring Factor",
       x = "Pcuring",
       y = "Number of Clusters") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 0, hjust = 1))


```

"cfactor"

```{r}
# The factor of curing
hotspots %>% 
  select(cfactor) %>% 
  count(cfactor)

cfactor_percentage <- hotspots$cfactor * 100
cfactor_percentage <- round(cfactor_percentage,2)
cfactor_percentage

```

"greenup"

```{r}
hotspots %>% 
  select(greenup) %>% 
  count(greenup)
```

"elev" (Elevation above sea level)

```{r}
# The elev can influencing local weather pattern, fuel moisture
ggplot(hotspots_peak, aes(x = elev)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Elevation at Fire Hotspots",
       x = "Elevation",
       y = "Frequency") +
  scale_y_continuous(labels = comma) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak, aes(x = factor(year), y = elev)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Elevation Distribution Across Years",
       x = "Year",
       y = "Elevation (in metre)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))

```

"cfl" (Crown Fire Load)

```{r}
ggplot(hotspots_peak, aes(x = cfl)) +
  geom_histogram(binwidth = 0.5, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Crown Fire Load at Fire Hotspots",
       x = "CFL (in kg/m짼)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))

```

```{r}
ggplot(hotspots_peak, aes(x = factor(year), y = cfl)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "CFL Distribution Across Years",
       x = "Year",
       y = "CFL (in kg/m짼)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

"tfc0"

```{r}
#Initial Total Fuel Consumption (kg/m짼)
ggplot(hotspots_peak, aes(x = tfc0)) +
  geom_histogram(binwidth = 0.1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Crown Fire Load at Fire Hotspots",
       x = "TFC0 (in kg/m짼)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak, aes(x = factor(year), y = tfc0)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Initial Total Fuel Consumption Distribution Across Years",
       x = "Year",
       y = "TFC0 (in kg/m짼)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))
```

"sfl" (Surface Fuel Load)

```{r}

ggplot(hotspots_peak, aes(x = sfl)) +
  geom_histogram(binwidth = 0.8, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Surface Fuel Load at Fire Hotspots",
       x = "SFL (in kg/m짼)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak, aes(x = factor(year), y = sfl)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Surface Fuel Load Distribution Across Years",
       x = "Year",
       y = "SFL (in kg/m짼)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))

```

"ecozone"

```{r}
hotspots_peak %>% 
  select(ecozone) %>% 
  count(ecozone)
```

```{r}
ggplot(hotspots_peak, aes(x = ecozone)) +
  geom_histogram(binwidth = 0.2, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Surface Fuel Load at Fire Hotspots",
       x = "SFL (in kg/m짼)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

"sfc0" (Initial Surface Fuel Consumption)

```{r}
ggplot(hotspots_peak, aes(x = sfc0)) +
  geom_histogram(binwidth = 0.1, fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Distribution of Surface Fuel Consumption at Fire Hotspots",
       x = "SFC0 (in kg/m짼)",
       y = "Frequency") +
  scale_y_continuous(labels = comma) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 10))
```

```{r}
ggplot(hotspots_peak, aes(x = factor(year), y = sfc0)) +
  geom_boxplot(fill = "steelblue", color = "black", alpha = 0.7) +
  labs(title = "Initial Surface Fuel Consumption Distribution Across Years",
       x = "Year",
       y = "SFC0 (in kg/m짼)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, size = 15),
        axis.title.x = element_text(size = 12),
        axis.title.y = element_text(size = 12),
        axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10))

```
